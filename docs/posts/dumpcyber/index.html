<!DOCTYPE html>
<html lang="en-us">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>DumpCyber - NozZy</title><meta name="Description" content="French Cybersecurity student and CTF enjoyer."><meta property="og:title" content="DumpCyber" />
<meta property="og:description" content="ECW 2023 prequals - DumpCyber Category Forensics
Description I am lost inside this dump, to escape I think I need my key and IV? The challenge is available here. Note: the flag format for this challenge is flag{...}.
Challenge made by: Yogosha
Difficulty Medium - 100 points
Author: SemahBA Screenshot Write up Understanding the context Profile and objective We got a RAM dump on a Windows 7, we&rsquo;ll use volatility for the analysis." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://nozyzy.github.io/posts/dumpcyber/" /><meta property="og:image" content="https://nozyzy.github.io/assets/nozzy.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-13T19:51:18+02:00" />
<meta property="article:modified_time" content="2023-10-13T19:51:18+02:00" /><meta property="og:site_name" content="NozZy" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://nozyzy.github.io/assets/nozzy.png" /><meta name="twitter:title" content="DumpCyber"/>
<meta name="twitter:description" content="ECW 2023 prequals - DumpCyber Category Forensics
Description I am lost inside this dump, to escape I think I need my key and IV? The challenge is available here. Note: the flag format for this challenge is flag{...}.
Challenge made by: Yogosha
Difficulty Medium - 100 points
Author: SemahBA Screenshot Write up Understanding the context Profile and objective We got a RAM dump on a Windows 7, we&rsquo;ll use volatility for the analysis."/>
      <meta name="twitter:site" content="@Nozzouille"/>
<meta name="application-name" content="NozZy">
<meta name="apple-mobile-web-app-title" content="NozZy"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://nozyzy.github.io/posts/dumpcyber/" /><link rel="prev" href="https://nozyzy.github.io/posts/stranger-case-2023/" /><link rel="next" href="https://nozyzy.github.io/posts/gishadb/" /><link rel="stylesheet" href="/css/style.min.cf6878db51c51b2d04ae155284a4403dbee8db33e16c066f954c95279c271fcd.css" integrity="sha256-z2h421HFGy0ErhVShKRAPb7o2zPhbAZvlUyVJ5wnH80="><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "DumpCyber",
        "inLanguage": "en-us",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/nozyzy.github.io\/posts\/dumpcyber\/"
        },"genre": "posts","keywords": "forensics, dump","wordcount":  1075 ,
        "url": "https:\/\/nozyzy.github.io\/posts\/dumpcyber\/","datePublished": "2023-10-13T19:51:18+02:00","dateModified": "2023-10-13T19:51:18+02:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "NozZy"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="NozZy"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="https://avatars.githubusercontent.com/u/60878689?v=4"
        data-srcset="https://avatars.githubusercontent.com/u/60878689?v=4, https://avatars.githubusercontent.com/u/60878689?v=4 1.5x, https://avatars.githubusercontent.com/u/60878689?v=4 2x"
        data-sizes="auto"
        alt="https://avatars.githubusercontent.com/u/60878689?v=4"
        title="https://avatars.githubusercontent.com/u/60878689?v=4" />NozZy</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/" title="Writeups"> Writeups </a><a class="menu-item" href="/articles/" title="Articles"> Articles </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/aboutme"> ./aboutme </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="NozZy"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="https://avatars.githubusercontent.com/u/60878689?v=4"
        data-srcset="https://avatars.githubusercontent.com/u/60878689?v=4, https://avatars.githubusercontent.com/u/60878689?v=4 1.5x, https://avatars.githubusercontent.com/u/60878689?v=4 2x"
        data-sizes="auto"
        alt="https://avatars.githubusercontent.com/u/60878689?v=4"
        title="https://avatars.githubusercontent.com/u/60878689?v=4" />NozZy</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="Writeups">Writeups</a><a class="menu-item" href="/articles/" title="Articles">Articles</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/aboutme" title="">./aboutme</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">DumpCyber</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="nozyzy.github.io" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>NozZy</a></span>&nbsp;<span class="post-category">included in <a href="/categories/writeups/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>Writeups</a>&nbsp;<a href="/categories/ecw-2023/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>ECW 2023</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="13-10-2023">13-10-2023</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;1075 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;6 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#category">Category</a></li>
    <li><a href="#description">Description</a></li>
    <li><a href="#difficulty">Difficulty</a></li>
    <li><a href="#write-up">Write up</a>
      <ul>
        <li><a href="#understanding-the-context">Understanding the context</a></li>
        <li><a href="#keys-and-decryption">Keys and decryption</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="ecw-2023-prequals---dumpcyber">ECW 2023 prequals - DumpCyber</h1>
<hr>
<h2 id="category">Category</h2>
<blockquote>
<p>Forensics</p>
</blockquote>
<h2 id="description">Description</h2>
<p>I am lost inside this dump, to escape I think I need my key and IV?
The challenge is available <a href="https://drive.google.com/file/d/12qaHQ5s3Yu4MD9clevbdwjmUNBsQ3q9h" target="_blank" rel="noopener noreffer ">here</a>.
Note: the flag format for this challenge is <code>flag{...}</code>.</p>
<p>Challenge made by: Yogosha</p>
<h2 id="difficulty">Difficulty</h2>
<p><strong>Medium</strong> - 100 points</p>
<ul>
<li>Author: <strong>SemahBA</strong></li>
</ul>
<hr>
<figure><a class="lightgallery" href="/DumpCyber/screen.png" title="Screenshot" data-thumbnail="/DumpCyber/screen.png" data-sub-html="<h2>Screenshot</h2><p>Screenshot</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/DumpCyber/screen.png"
            data-srcset="/DumpCyber/screen.png, /DumpCyber/screen.png 1.5x, /DumpCyber/screen.png 2x"
            data-sizes="auto"
            alt="Screenshot" />
    </a><figcaption class="image-caption">Screenshot</figcaption>
    </figure>
<h2 id="write-up">Write up</h2>
<h3 id="understanding-the-context">Understanding the context</h3>
<h4 id="profile-and-objective">Profile and objective</h4>
<p>We got a RAM dump on a Windows 7, we&rsquo;ll use <a href="https://github.com/volatilityfoundation/volatility" target="_blank" rel="noopener noreffer ">volatility</a> for the analysis.</p>
<pre tabindex="0"><code>┌──(nozzy㉿shoggoth)-[~/Documents/ECW]
└─$ vol -f task.raw imageinfo
Volatility Foundation Volatility Framework 2.6.1
INFO    : volatility.debug    : Determining profile based on KDBG search...
          Suggested Profile(s) : Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_24000, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_24000, Win7SP1x64_23418
                     AS Layer1 : WindowsAMD64PagedMemory (Kernel AS)
                     AS Layer2 : FileAddressSpace (/home/nozzy/Documents/ECW/task.raw)
                      PAE type : No PAE
                           DTB : 0x187000L
                          KDBG : 0xf800027fd0a0L
          Number of Processors : 1
     Image Type (Service Pack) : 1
                KPCR for CPU 0 : 0xfffff800027fed00L
             KUSER_SHARED_DATA : 0xfffff78000000000L
           Image date and time : 2023-08-17 16:20:26 UTC+0000
     Image local date and time : 2023-08-17 17:20:26 +0100```
</code></pre><p>The description lets us know that we&rsquo;ll have to look for a <strong>key</strong> and an <strong>IV</strong> (initial vector), which are used for symmetric encryption. The most common one is <strong>AES</strong>, and its most common mode using an IV is <strong>CBC</strong>. We&rsquo;ll keep that in mind.</p>
<h4 id="processes-and-commands">Processes and commands</h4>
<p>I am used to checking for the last commands run by the user, and what processes are running. So I ran the commands <code>cmdline</code> and <code>pstree</code>.
The only processes of interest were <code>notepad.exe</code> and <code>WinRar.exe</code> :</p>
<p>cmdline:</p>
<pre tabindex="0"><code>WinRAR.exe pid:   2144
Command line : &#34;C:\Program Files\WinRAR\WinRAR.exe&#34; &#34;C:\Users\vboxuser\Desktop\c&#34;
************************************************************************
WinRAR.exe pid:   1280
Command line : &#34;C:\Program Files\WinRAR\WinRAR.exe&#34; &#34;C:\Users\vboxuser\Desktop\generator.rar&#34;
************************************************************************
notepad.exe pid:   2880
Command line : &#34;C:\Windows\system32\NOTEPAD.EXE&#34; C:\Users\vboxuser\Desktop\deesktop.ini
************************************************************************
notepad.exe pid:   2792
Command line : &#34;C:\Windows\system32\NOTEPAD.EXE&#34; C:\Users\vboxuser\Desktop\dessktop.ini
************************************************************************
WinRAR.exe pid:   2624
Command line : &#34;C:\Program Files\WinRAR\WinRAR.exe&#34; &#34;C:\Users\vboxuser\Desktop\file.rar&#34;
</code></pre><p>Pstree:</p>
<pre tabindex="0"><code>0xfffffa80041c8510:explorer.exe                     1160   1140     36    969 2023-08-17 16:13:47 UTC+0000
. 0xfffffa8004480b30:VBoxTray.exe                    1428   1160     13    137 2023-08-17 16:13:48 UTC+0000
. 0xfffffa8000dc4b30:DumpIt.exe                      1320   1160      2     45 2023-08-17 16:20:19 UTC+0000
. 0xfffffa8001000b30:WinRAR.exe                      1280   1160      6    188 2023-08-17 16:20:22 UTC+0000
. 0xfffffa8000e2cb30:WinRAR.exe                      2624   1160      6    188 2023-08-17 16:20:25 UTC+0000
. 0xfffffa8001025b30:WinRAR.exe                      2144   1160      6    188 2023-08-17 16:20:21 UTC+0000
. 0xfffffa8000f8fb30:notepad.exe                     2880   1160      1     61 2023-08-17 16:20:23 UTC+0000
. 0xfffffa8000fe8b30:notepad.exe                     2792   1160      1     61 2023-08-17 16:20:24 UTC+0000
</code></pre><p>Two files seamed to be edited by the user : <code>deesktop.ini</code> and <code>dessktop.ini</code>
Note that they are fake versions of the common <code>desktop.ini</code> that exists on Windows. They might look interesting.</p>
<p>Then, three rar archives also exist : <code>file.rar</code>, <code>generator.rar</code> and <code>file.txt.rar</code></p>
<h4 id="dumping-the-files">Dumping the files</h4>
<p>Now that we found interesting stuff, we&rsquo;re going to <strong>dump</strong> them and ake a look at it using the <code>filescan</code> and <code>dumpfiles</code> commands.</p>
<p>Using the first one, we are able to find every file loaded in memory by the computer, and locate their physical offset in the dump.
Here ar all the files we&rsquo;re looking for :</p>
<pre tabindex="0"><code>0x000000003fd737b0     16      0 RW---- \Device\HarddiskVolume1\Users\vboxuser\Desktop\deesktop.ini
0x000000003fcd2430     16      0 RW---- \Device\HarddiskVolume1\Users\vboxuser\Desktop\dessktop.ini
0x000000003fa18070     16      0 RW---- \Device\HarddiskVolume1\Users\vboxuser\Desktop\file.txt.rar
0x000000003fa144a0     16      0 RW---- \Device\HarddiskVolume1\Users\vboxuser\Desktop\generator.rar
0x000000000ef58430     16      0 RW---- \Device\HarddiskVolume1\Users\vboxuser\Desktop\file.rar
</code></pre><div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>dumpfiles<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">We&rsquo;ll now use the hexadecimal offset to dump their content, with the command: <code>vol -f task.raw --profile=Win7SP1x64 dumpfiles -Q &lt;offset&gt; -D .</code></div>
        </div>
    </div>
<p>We now have these files:</p>
<pre tabindex="0"><code>deesktop.ini:   file.None.0xfffffa8003e37b10.dat
dessktop.ini:   file.None.0xfffffa8000c7d9e0.dat
file.txt.rar:   file.None.0xfffffa800487b860.dat
generator.rar:  file.None.0xfffffa8003fc9160.dat
file.rar:       NONE
</code></pre><p>All the dumped files are <strong>rar archives</strong>:</p>
<pre tabindex="0"><code>┌──(nozzy㉿shoggoth)-[~/Documents/ECW/dump]
└─$ for FILE in *; do file $FILE; done
file.None.0xfffffa8000c7d9e0.dat: RAR archive data, v5
file.None.0xfffffa8003e37b10.dat: RAR archive data, v5
file.None.0xfffffa8003fc9160.dat: RAR archive data, v5
file.None.0xfffffa800487b860.dat: RAR archive data, v5
</code></pre><p>Using <code>unrar x &lt;file&gt;</code> we can extract everything, that gave us the 4 resulting files <code>deesktop.ini  dessktop.ini  file.txt.enc  generator.exe</code>.</p>
<div class="details admonition info open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-info-circle fa-fw" aria-hidden="true"></i>nopad<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>At this point we got:</p>
<ul>
<li>Two fake <code>desktop.ini</code> containing unreadable data.</li>
<li><code>file.txt.enc</code> with unreadable bytes data, apparently encrypted according to the extension .enc. This might be our encrypted flag.</li>
<li><code>generator.exe</code>, a 32-bit Windows executable file.</li>
</ul></div>
        </div>
    </div>
<h3 id="keys-and-decryption">Keys and decryption</h3>
<p>My first try, even before checking for the context, was to look for the key in memory with <a href="https://sourceforge.net/projects/findaes/files/findaes-1.2.zip/download" target="_blank" rel="noopener noreffer ">findaes</a>. This is a tool that I already used in that <a href="/articles/decrypt-luks1-with-key-in-memory/" rel="">article</a>, which allows us to look for AES keys stored in a dump file.
That worked, we got two 128-bits AES keys :</p>
<pre tabindex="0"><code>Found AES-128 key schedule at offset 0x3655164:
3d 68 2f 1a 3d 5e 04 20 8e 23 29 75 bd e6 c5 9b
Found AES-128 key schedule at offset 0x106b9260:
29 60 1b 94 90 87 c9 fa a6 de f2 91 c4 8d b9 c7
</code></pre><p>At this point, I thought that I only had to find for the IV, which is 16 bytes (128-bits) long.</p>
<p>By chance, both our <code>deesktop.ini</code> and <code>dessktop.ini</code> were 16-bytes long files:</p>
<pre tabindex="0"><code>┌──(nozzy㉿shoggoth)-[~/Documents/ECW/dump]
└─$ xxd deesktop.ini &amp;&amp; xxd dessktop.ini
00000000: e609 874a 80d1 b27e fd46 cc0a 131a 4dcd  ...J...~.F....M.

00000000: 1b54 ee42 0bd5 b839 6e15 fc9f e010 55f8  .T.B...9n.....U.

┌──(nozzy㉿shoggoth)-[~/Documents/ECW]
└─$ wc -c dessktop.ini &amp;&amp; wc -c deesktop.ini
16 dessktop.ini
16 deesktop.ini
</code></pre><p>Or, if we take a look closely at the content of both our files, none of them corresponds to the keys we previously found with aesfinder.</p>
<p>Before trying some dumb combinaisons, we need to figure out the purpose of the last file: <code>generator.exe</code>
I ran it with win, in 32-bit config, under linux, in an empty directory:</p>
<pre tabindex="0"><code>┌──(nozzy㉿shoggoth)-[~/Documents/ECW/test]
└─$ ls
generator.exe

┌──(nozzy㉿shoggoth)-[~/Documents/ECW/test]
└─$ wine generator.exe
Key and IV written to files.

┌──(nozzy㉿shoggoth)-[~/Documents/ECW/test]
└─$ 
ls
deesktop.ini  dessktop.ini  generator.exe
</code></pre><p>This is what we wanted: to confirm that both <code>.ini</code> files are the Key and the IV. We do not have to use the keys found with aesfinder.</p>
<p>Decrypting is the last step:</p>
<pre tabindex="0"><code>┌──(nozzy㉿shoggoth)-[~/Documents/ECW]
└─$ openssl enc -aes-128-cbc -d -in file.txt.enc -out file.txt -K &#39;1b54ee420bd5b8396e15fc9fe01055f8&#39; -iv &#39;e609874a80d1b27efd46cc0a131a4dcd&#39;
bad decrypt
4037C9F7C87F0000:error:1C800064:Provider routines:ossl_cipher_unpadblock:bad decrypt:../providers/implementations/ciphers/ciphercommon_block.c:124:
</code></pre><div class="details admonition danger open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-skull-crossbones fa-fw" aria-hidden="true"></i>nopad<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">Error with the pad? What if we remove it with <code>-nopad</code>?</div>
        </div>
    </div>
<pre tabindex="0"><code>┌──(nozzy㉿shoggoth)-[~/Documents/ECW]
└─$ openssl enc -aes-128-cbc -d -in file.txt.enc -out file.txt -K &#39;1b54ee420bd5b8396e15fc9fe01055f8&#39; -iv &#39;e609874a80d1b27efd46cc0a131a4dcd&#39; -nopad

┌──(nozzy㉿shoggoth)-[~/Documents/ECW]
└─$ cat file.txt
=�;K   ��Al��
                0flag{82a30fadcfc07d634fbed1bffe4a2aa1}
</code></pre><div class="details admonition success">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-check-circle fa-fw" aria-hidden="true"></i>Flag<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">&#x1f6a9; <code>flag{82a30fadcfc07d634fbed1bffe4a2aa1}</code>
Key : <code>dessktop.ini</code> -&gt; <code>1b54ee420bd5b8396e15fc9fe01055f8</code>
IV : <code>deesktop.ini</code> -&gt; <code>e609874a80d1b27efd46cc0a131a4dcd</code></div>
        </div>
    </div>
<div class="details admonition question open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-question-circle fa-fw" aria-hidden="true"></i>And aesfinder ?<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>aesfinder could have found other keys in the dump. However, he couldn&rsquo;t manage to find ours, which are correctly visible in the hex dump of <code>task.raw</code>:</p>
<pre tabindex="0"><code>┌──(nozzy㉿shoggoth)-[~/Documents/ECW]
└─$ xxd task.raw | grep -C1 &#39;1b54 ee42 0bd5&#39;
01977030: 736b 746f 702e 696e 690a 0302 94a1 57b6  sktop.ini.....W.
01977040: fba4 d901 1b54 ee42 0bd5 b839 6e15 fc9f  .....T.B...9n...
01977050: e010 55f8 1d77 5651 0305 0400 0000 0000  ..U..wVQ........
</code></pre></div>
        </div>
    </div>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>TL;DR<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>suspect <code>.ini</code> and <code>.rar</code> files used respectively by <code>notepad.exe</code> and <code>WinRar.exe</code></li>
<li>dumping and extracting files</li>
<li><code>generator.exe</code> creates to files:
<ul>
<li>the Key <code>dessktop.ini</code></li>
<li>the IV <code>deesktop.ini</code></li>
</ul>
</li>
<li>decrypt <code>file.txt.enc</code> with dumped <code>dessktop.ini</code> and <code>deesktop.ini</code></li>
</ul>
</div>
        </div>
    </div>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 13-10-2023</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://nozyzy.github.io/posts/dumpcyber/" data-title="DumpCyber" data-via="Nozzouille" data-hashtags="forensics,dump"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="https://nozyzy.github.io/posts/dumpcyber/"><i class="fab fa-linkedin fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://nozyzy.github.io/posts/dumpcyber/" data-title="DumpCyber"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="https://nozyzy.github.io/posts/dumpcyber/" data-title="DumpCyber"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://nozyzy.github.io/posts/dumpcyber/" data-title="DumpCyber"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/forensics/">Forensics</a>,&nbsp;<a href="/tags/dump/">Dump</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/stranger-case-2023/" class="prev" rel="prev" title="Stranger Case 2023"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Stranger Case 2023</a>
            <a href="/posts/gishadb/" class="next" rel="next" title="Gishadb">Gishadb<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.124.1">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2023 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="nozyzy.github.io" target="_blank">NozZy</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":30},"comment":{},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30}};</script><script type="text/javascript" src="/js/theme.min.d7121d72cd85153ec9d35a888cee3eb28c2700ca763f649a538f6c772d750021.js" integrity="sha256-1xIdcs2FFT7J01qIjO4+sownAMp2P2SaU49sdy11ACE="></script></body>
</html>
